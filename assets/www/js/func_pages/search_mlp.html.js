function init(){var e=getArgs().type;data_all=getFjdzlb(),this_type_all=data_all.filter(function(t){return t.dztype==e}),create_list(this_type_all)}function create_list(e){e.length>0?(e.forEach(function(e){var t=createItem(e);$("#search_list").append(t),""!=e.mapx&&createMarker(e)}),$("#dz_list_nodata").hide(),$("#search_list").fadeIn()):($("#dz_list_nodata").fadeIn(),$("#search_list").hide()),map.setFitView()}function createMarker(e){var t=new AMap.Marker({map:map,icon:"./img/location_b.png",position:[e.mapx,e.mapy],offset:new AMap.Pixel(-12,-36),extData:{systemid:e.systemid}});"xqjzw"==e.dztype?t.setIcon("./img/location_b.png"):"jzwdz"==e.dztype?t.setIcon("./img/location_b.png"):"fwxc"==e.dztype&&t.setIcon("./img/location_b.png"),t.on("click",function(){var a=new AMap.InfoWindow({content:createInfoWindow(e),offset:new AMap.Pixel(-2,-25)});a.open(map,t.getPosition()),lastMarker&&lastMarker.setIcon(lastIcon),lastMarker=t,lastIcon=t.getIcon(),t.setIcon("./img/location_r.png"),liftClickedItem(e.systemid),restoreLastItem(),lastClickedItem=e.systemid,this.setTop(!0)}),markers.push(t)}function liftClickedItem(e){var t="#"+e;$(t).parent().prepend($(t)),$(t).css("background-color","lightblue")}function restoreLastItem(){if(lastClickedItem){var e="#"+lastClickedItem;$(e).css("background-color","white")}}function select_item(e){for(var t=0;t<markers.length;t++){var a=markers[t];if(e==a.getExtData().systemid){lastMarker&&lastMarker.setIcon(lastIcon),lastMarker=a,lastIcon=a.getIcon(),a.setIcon("./img/location_r.png"),liftClickedItem(e),restoreLastItem(),lastClickedItem=e,a.setTop(!0),map.setFitView();break}}}function searchDz(){var e=$("#search").val();return 0===this_type_all.length?void $.alert("搜索结果为空"):(map.clearMap(),$("#search_list").hide(),$("#search_list").empty(),this_type_all.forEach(function(t){if(""!=e&&t.all_full_addr.indexOf(e)!=-1){var a=createItem(t);$("#search_list").append(a),""!=t.mapx&&createMarker(t)}else if(""==e){var r=createItem(t);$("#search_list").append(r),""!=t.mapx&&createMarker(t)}}),map.setFitView(),void $("#search_list").fadeIn())}setCurrentCategory("fj");var lastMarker,lastIcon,lastClickedItem,markers=[],data_all,this_type_all;