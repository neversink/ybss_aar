function init(){if($(".to-top").toTop({}),$("#quxcun").html(quxcun),$("#all_full_addr").html(all_full_addr),$('input[name = "all_full_addr"]').val(all_full_addr),$('input[name = "systemid"]').val(systemid),$('input[name = "procmode"]').val(procmode),$('input:radio[name="gas_unit"]').change(function(){var t=$(this).val();init_gqqymc_sp(t)}),$('input:radio[name="bottle_type"]').change(function(){var t=$(this).val();init_gpgg_sp(t)}),$('input:radio[name="gas_envi"]').change(function(){var t=$(this).val();init_yqhj_sp(t)}),$('input:radio[name="hose"]').change(function(){var t=$(this).val();init_rg_sp(t)}),$('input:radio[name="gas_type"]').change(function(){var t=$(this).val();"瓶装"===t?($("#scan_btn").show(),$("#otherwise_pz").show()):"管道"===t?($("#scan_btn").hide(),$("#otherwise_pz").hide()):"其他"===t&&($("#scan_btn").hide(),$("#otherwise_pz").hide())}),$('input:radio[name="user_type"]').change(function(){var t=$(this).val();init_yhlx(t)}),$('input[name="pid"]').blur(function(){var t=$('input[name="pid"]').val(),a=new AjaxJsonRequest("bjrk_list.jsp");a.setData("sfzh",t),a.send("正在获取人员信息",function(t){if(t.datas.length>0){var a=t.datas[0];a.CZRKXM&&a&&($('input[name="name"]').val(a.CZRKXM?a.CZRKXM:""),$('input[name="lxfs"]').val(a.CZRKLXFS?a.CZRKLXFS:""))}},function(t){$.alert("获取人员信息失败："+t)})}),"PMUPDATE"===procmode){$('input[name="czlx"]').val("bg"),$('input[name="nid"]').val(id);var t=new AjaxJsonRequest("t_gas_user_list.jsp");t.setData("systemid",systemid),t.setData("nid",id),t.send("正在获取钢瓶信息",function(t){loadDataToForm(t.datas[0]),"瓶装"===t.datas[0].gas_type&&($("#scan_btn").show(),$("#otherwise_pz").show()),init_yhlx(t.datas[0].user_type),init_gqqymc_sp(t.datas[0].gas_unit),init_gpgg_sp(t.datas[0].bottle_type),init_yqhj_sp(t.datas[0].gas_envi),init_rg_sp(t.datas[0].hose)},function(t){$.alert("获取钢瓶信息失败："+t)})}else $('input[name="czlx"]').val("xz")}function init_yhlx(t){"居民用户"===t?($("#cydm").hide(),$("#cydm .item-title label").html('餐饮店名<br>&nbsp(企业名)<span class="table-redstar">*</span>'),$("#yyzz").hide(),$('input[name="unit_name"]').val(""),$('input[name="bl_code"]').val("")):"餐饮用户"===t?($("#cydm").show(),$("#cydm .label").html('餐饮店名<span class="table-redstar">*</span>'),$("#yyzz").show()):"工业用户"===t&&($("#cydm").show(),$("#cydm .label").html('企业名<span class="table-redstar">*</span>'),$("#yyzz").show())}function init_gqqymc_sp(t){var a="gqqymc_div";"其他"===t?show_content(a):($('input[name="gqqymc_name"]').val(""),hide_content(a))}function init_gpgg_sp(t){var a="gpgg_div";"其他"===t?show_content(a):($('input[name="gpgg_name"]').val(""),hide_content(a))}function init_yqhj_sp(t){var a="yqhj_div";"其他"===t?show_content(a):($('input[name="yqhj_name"]').val(""),hide_content(a))}function init_rg_sp(t){var a="rg_div";"其他"===t?show_content(a):($('input[name="rg_name"]').val(""),hide_content(a))}function hide_content(t){var a="#"+t;$(a).hide()}function show_content(t){var a="#"+t;$(a).show()}function sendReq(){var t=new AjaxJsonRequest("t_gas_user_save.jsp"),a=$('input:radio[name="gas_type"]:checked').val(),e=$('input:radio[name="user_type"]:checked').val(),n=new NotNullField;"瓶装"!==a?(n.add("yqlx","用气类型"),t.setData("systemid",systemid),t.setData("all_full_addr",all_full_addr),t.setData("gas_type",a),t.setNotNotNullField(n),t.send("燃气钢瓶信息提交中...",success,error)):"瓶装"===a&&(t.setData("gas_type",""),t.setData("user_type",""),t.setData("gas_unit",""),t.setData("bottle_type",""),t.setData("gas_env",""),t.setData("hose",""),t.loadDataFromForm("form"),n.add("systemid","地址编码"),n.add("all_full_addr","地址"),n.add("gas_type","用气类型"),n.add("user_type","用户类型"),n.add("name","用户姓名"),n.add("pid","身份证号"),n.add("lxfs","联系电话"),"居民用户"!==e&&(n.add("unit_name","餐饮店名（企业名）"),n.add("bl_code","工商营业执照证号")),n.add("gas_unit","供气企业名称"),n.add("bottle_type","钢瓶规格"),n.add("gas_envi","用气环境"),n.add("hose","软管情况"),$("#gqqymc_div").is(":visible")&&n.add("gas_unit_other","供气企业名称"),$("#gpgg_div").is(":visible")&&n.add("bottle_type_other","钢瓶规格"),$("#yqhj_div").is(":visible")&&n.add("gas_envi_other","用气环境"),$("#rg_div").is(":visible")&&n.add("hose_other","软管情况"),t.setNotNotNullField(n),t.send("燃气钢瓶信息提交中...",success,error))}function success(t){$.modal({text:"燃气钢瓶保存成功",buttons:[{text:"继续增加",onClick:function(){add_another()}},{text:"返回",onClick:function(){go_back()}}]})}function error(t){$.alert("燃气钢瓶信息保存失败，"+t)}function rqgp_scan(){tchScanQrcode(function(t){$('input[name = "bottle_tm"]').val(t.text),$.alert(t.text),t.text?quote_gp(t.text):$.alert("扫描钢瓶条码为空！")},function(t){$('input[name = "bottle_tm"]').val(""),$.alert("扫描二维码出错，"+t)},"")}function quote_gp(t){var a=new AjaxJsonRequest("bd_rqgp_list.jsp");a.setData("code",t),a.send("燃气钢瓶信息搜索中...",function(t){var a=t.datas[0],e=a.companyname,n=a.bottleid,i=a.specname;$('input[name="bottle_gph"]').val(n),$('input[value = "'+e+'"]').attr("checked",!0),"5KG"===i.substring(0,3)?$('input[value = "YSP12（5kg）"]').attr("checked",!0):"15KG"===i.substring(0,4)?$('input[value = "YSP35.5（15kg）"]').attr("checked",!0):"50KG"===i.substring(0,4)?$('input[value = "YSP118（50kg）"]').attr("checked",!0):($('input[value = "其他"]').attr("checked",!0),init_gpgg_sp("其他"))},function(t){$.alert("获取钢瓶信息失败，"+t)})}function go_back(){history.go(-1)}function add_another(){$('input[name = "bottle_gph"]').val(""),$('input[name = "bottle_tm"]').val(""),$('input[name = "nid"]').val(""),$('input[name = "procmode"]').val("PMINSERT"),$('input[name = "czlx"]').val("xz"),$(".to-top").click()}var quxcun=get_current_quxcun(),all_full_addr=get_current_all_full_addr(),systemid=get_current_system_id(),procmode=getArgs().procmode,id=getArgs().id;