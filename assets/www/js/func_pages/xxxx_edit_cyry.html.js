function init(){$("#quxcun").html(quxcun),$("#all_full_addr").html(all_full_addr),$('input[name="systemid"]').val(systemid),$('input[name="all_full_addr"]').val(all_full_addr),$('input[name="dwmc"]').val(dwmc),$('input[name="dwid"]').val(dwid),$('input[name="procmode"]').val(procmode),$('input[name="cyry_id"]').val(ryid),$('input[name="rylx"]').val("jnry"),"PMINSERT"==procmode?prepare_for_new():"PMDETAIL"==procmode?prepare_for_watch():"PMUPDATE"==procmode&&prepare_for_edit()}function prepare_for_new(){$('input[name="czlx"]').val("xz"),$("#zjlx").val("居民身份证"),$('input[name="zjhm"]').blur(function(){getsfz($('input[name="zjhm"]').val())})}function prepare_for_edit(){pojo=getCurrentCyryItem(),$('input[name="czlx"]').val("bg"),$('input[name="procmode"]').val("PMINSERT"),$('input[name="person_id"]').val(pojo.person_id),loadDataToForm(pojo),closeAllInput("form"),$('input[name = "btn_save"]').removeAttr("disabled"),$('input[name = "lxfs"]').removeAttr("readonly"),$('input[name = "lxfs"]').removeAttr("disabled"),$.alert("仅可修改从业人员联系方式")}function prepare_for_watch(){if($('input[name = "btn_save"]').hide(),"rz"===type){var e=new AjaxJsonRequest("cyry_list.jsp");e.setData("dwid",dwid),e.setData("cyry_id",ryid),e.send("从业人员获取中",function(e){loadDataToForm(e.datas[0]),closeAllInput("form")},function(e){$.alert("从业人员信息获取失败，"+e)})}else"cyry"===type?pojo=getCurrentCyryItem():"zxcjry"===type&&(pojo=getCurrentZxcjryItem()),loadDataToForm(pojo),closeAllInput("form")}function common_prepare(){}function sendReq(){var e=new AjaxJsonRequest("cyry_save.jsp");"PMUPDATE"==procmode?(openAllInput("form"),e.loadDataFromForm("form"),closeAllInput("form")):e.loadDataFromForm("form");var n=new NotNullField;n.add("zjhm","证件类型"),n.add("zjhm","证件号码"),n.add("name","姓名"),n.add("lxfs","联系方式"),e.setNotNotNullField(n),e.send("从业人员信息提交中",function(e){showTchToast("从业人员保存成功","-1",function(){go_back()})},function(e){$.alert("从业人员保存失败，"+e)})}function go_back(){history.go(-1)}function openDict(e,n,t,a){openDictDialog(e,n,t,a)}function changeHiddenIdCard(e,n){"居民身份证"==n?($('input[name="zjhm"]').blur(function(){getsfz($('input[name="zjhm"]').val())}),$("#hjdqx").show(),$("#hjdzz").show()):($('input[name="zjhm"]').unbind("blur"),$("#hjdqx").hide(),$("#hjdzz").hide())}function getsfz(e){if(""!=e&&isIdCardNum(e)){var n=new AjaxJsonRequest("bjrk_list.jsp");n.setData("sfzh",e),n.send("正在获取人员信息",function(e){if(e.datas.length>0){var n=e.datas[0];n.CZRKXM&&n?($('input[name="name"]').val(n.CZRKXM?n.CZRKXM:""),$('input[name="lxfs"]').val(n.CZRKLXFS?n.CZRKLXFS:""),$('input[name="hjdssx"]').val(n.CZRKSSSSXQ?n.CZRKSSSSXQ:""),n.CZRKZZ&&n.CZRKSSSSXQ&&$('input[name="hjdxz"]').val(n.CZRKZZ.substring(n.CZRKSSSSXQ.length))):($('input[name="name"]').val(""),$('input[name="lxfs"]').val(""),$('input[name="hjdssx"]').val(""),$('input[name="hjdxz"]').val(""))}},function(e){$.alert("获取人员信息失败，"+e)})}}var dwid=get_current_dw_id(),dwmc=get_current_dwmc(),quxcun=get_current_quxcun(),all_full_addr=get_current_all_full_addr(),systemid=get_current_system_id(),procmode=getArgs().procmode,type=getArgs().type,ryid=getArgs().cyry_id,pojo;