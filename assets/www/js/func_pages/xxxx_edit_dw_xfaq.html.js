function init(){"fw"===type?($("#dw").html(all_full_addr),$('input[name="all_full_addr"]').val(all_full_addr),$('input[name="systemid"]').val(systemid),$('input[name="house_id"]').val(houseid),$('input[value="人员密集场所"]').attr("disabled","disabled"),$('input[value="易燃易爆"]').attr("disabled","disabled"),$('input[value="其他类别"]').attr("disabled","disabled"),$('input[value="居住出租房"]').attr("checked","checked"),$("#cslbxl").attr("onclick","open_local_cs_3()")):"dw"===type&&($("#dw").html(dwmc),$("#dz").html(all_full_addr),$('input[name="all_full_addr"]').val(all_full_addr),$('input[name="systemid"]').val(systemid),$('input[name="unit_name"]').val(dwmc),$('input[name="unit_nid"]').val(dwid),$('input[name="fzr_name"]').val(fzr),$('input[name="fzr_tel"]').val(fzrlxfs),$('input[value="居住出租房"]').attr("disabled","disabled"));var e=new AjaxJsonRequest("xf_list.jsp");"fw"===type?e.setData("house_id",houseid):"dw"===type&&e.setData("dwid",dwid),e.send("消防信息获取中...",function(e){e.datas.length>0?(prepare_for_edit(),loadDataToForm(e.datas[0]),special_handle(e.datas[0])):prepare_for_new()},function(e){$.alert("消防信息获取失败，"+datas),prepare_for_watch()}),common_prepare()}function prepare_for_new(){$('input[name="procmode"]').val("PMINSERT"),$('input[name="czlx"]').val("xz")}function prepare_for_edit(){$('input[name="procmode"]').val("PMUPDATE"),$('input[name="czlx"]').val("bg")}function prepare_for_watch(){$('input[name="czlx"]').val("")}function common_prepare(){}function special_handle(e){spilt_into_checkbox("yhqk",e.yhqk),spilt_into_checkbox("dqlx",e.dqlx),spilt_into_checkbox("mhq",e.mhq),spilt_into_checkbox("xhs",e.xhs),spilt_into_checkbox("fhm",e.fhm),spilt_into_checkbox("aqck",e.aqck),spilt_into_checkbox("sstd",e.sstd),spilt_into_checkbox("fire_cs",e.fire_cs),init_place_type(e.place_type),init_shy(e.shy),init_fire_kzs(e.fire_kzs),init_fire_sp(e.fire_sp)}function spilt_into_checkbox(e,t){if(t)for(var a=t.split(";"),c=0;c<a.length-1;c++){var i=a[c],n="input:checkbox[name="+e+"_cb][value="+i+"]";$(n).attr("checked","true")}}function init_shy(e){var t="shy_div";"有"===e?show_content(t):hide_content(t)}function init_fire_kzs(e){var t="kzs_div";"有"===e?show_content(t):hide_content(t)}function init_fire_sp(e){var t="fire_sp_div";"其他情况"===e?show_content(t):hide_content(t)}function init_place_type(e){e.indexOf("人员")>-1?$("#cslbxl").attr("onclick","open_local_cs_1()"):e.indexOf("易燃")>-1?$("#cslbxl").attr("onclick","open_local_cs_2()"):e.indexOf("居住")>-1?$("#cslbxl").attr("onclick","open_local_cs_3()"):e.indexOf("其他")>-1&&$("#cslbxl").attr("onclick","open_local_cs_4()")}function open_local_cs_1(){openLocalDictDialog("人员密集场所","消防场所类别_人员密集场所_本地","place_minortype","")}function open_local_cs_2(){openLocalDictDialog("易燃易爆","消防场所类别_易燃易爆_本地","place_minortype","")}function open_local_cs_3(){openLocalDictDialog("居住出租房居住人数","消防场所类别_居住出租房_本地","place_minortype","")}function open_local_cs_4(){openLocalDictDialog("其他类别","消防场所类别_其他类别_本地","place_minortype","")}function hide_content(e){var t="#"+e;$(t).hide(),closeAllInput(e)}function show_content(e){var t="#"+e;$(t).show(),openAllInput(e)}function success(e){showTchToast("消防信息保存成功","-1",function(){go_back()})}function error(e){$.alert("消防信息保存失败，"+e)}function go_back(){history.go(-2)}var type=getArgs().type,dwid=getArgs().dwid,houseid=getArgs().houseid,dwmc=getArgs().dwmc,fzr=getArgs().fzr,fzrlxfs=getArgs().fzrlxfs,quxcun=get_current_quxcun(),all_full_addr=get_current_all_full_addr(),systemid=get_current_system_id(),yhqk_cb="",dqlx_cb="",mhq_cb="",xhs_cb="",fhm_cb="",aqck_cb="",sstd_cb="",fire_cs_cb="";$(function(){$("#save_btn").click(function(){var e=new AjaxJsonRequest("xf_save.jsp");e.setData("building_type",""),e.setData("place_type",""),e.setData("place_license_sf",""),e.setData("fire_sp",""),e.setData("fire_kzs",""),e.setData("fire_td",""),e.setData("sszsbz",""),e.setData("yjzm",""),e.setData("zaw",""),e.setData("shy",""),e.setData("shy_zsfl",""),e.setData("shy_dltd",""),e.setData("yjzm",""),yhqk_cb="",dqlx_cb="",mhq_cb="",xhs_cb="",fhm_cb="",aqck_cb="",sstd_cb="",fire_cs_cb="",e.loadDataFromForm("form"),$("input:checkbox[name=yhqk_cb]:checked").each(function(e){yhqk_cb+=$(this).val()+";"}),$("input:checkbox[name=dqlx_cb]:checked").each(function(e){dqlx_cb+=$(this).val()+";"}),$("input:checkbox[name=mhq_cb]:checked").each(function(e){mhq_cb+=$(this).val()+";"}),$("input:checkbox[name=xhs_cb]:checked").each(function(e){xhs_cb+=$(this).val()+";"}),$("input:checkbox[name=fhm_cb]:checked").each(function(e){fhm_cb+=$(this).val()+";"}),$("input:checkbox[name=aqck_cb]:checked").each(function(e){aqck_cb+=$(this).val()+";"}),$("input:checkbox[name=sstd_cb]:checked").each(function(e){sstd_cb+=$(this).val()+";"}),$("input:checkbox[name=fire_cs_cb]:checked").each(function(e){fire_cs_cb+=$(this).val()+";"}),e.setData("yhqk",yhqk_cb),e.setData("dqlx",dqlx_cb),e.setData("mhq",mhq_cb),e.setData("xhs",xhs_cb),e.setData("fhm",fhm_cb),e.setData("aqck",aqck_cb),e.setData("sstd",sstd_cb),e.setData("fire_cs",fire_cs_cb);var t=new NotNullField;t.add("all_full_addr","地址"),t.add("pt_name","陪同人姓名"),t.add("pt_tel","陪同人联系电话"),t.add("building_name","所在主体建筑名称"),t.add("building_type","所在主体建筑类型"),t.add("building_high","所在主体建筑高度"),t.add("building_floor","所在主体建筑层数"),t.add("place_position","场所位于主体层数"),t.add("place_area","场所建筑面积"),t.add("place_type","场所类别大类"),t.add("place_minortype","场所类别细类"),t.add("place_license_sf","持证情况"),t.add("fire_sp","消防审批"),t.add("fire_kzs","消防控制室"),t.add("fire_td","消防车通道"),t.add("sszsbz","疏散指示标志"),t.add("yjzm","应急照明"),t.add("zaw","外窗是否设置影响逃生、灭火救援的障碍物"),t.add("shy","是否存在“三合一”情况"),$("#place_license_div").is(":visible"),$("#kzs_div").is(":visible")&&(t.add("fire_kzs_zbrs","值班在岗人数"),t.add("fire_kzs_czrs","持证人数")),$("#shy_div").is(":visible")&&(t.add("shy_zsfl","住宿与非住宿部分是否完全防火分"),t.add("shy_dltd","住宿与非住宿部分疏散楼梯、安全出口是否分别独立设置")),e.setNotNotNullField(t),e.send("消防信息提交中...",success,error)}),$('input:radio[name="shy"]').change(function(){var e=$(this).val();init_shy(e)}),$('input:radio[name="fire_kzs"]').change(function(){var e=$(this).val();init_fire_kzs(e)}),$('input:radio[name="fire_sp"]').change(function(){var e=$(this).val();init_fire_sp(e)}),$('input:radio[name="place_type"]').change(function(){var e=$(this).val();init_place_type(e),$("#cslbxl").val(""),$("#cslbxl").click()})});