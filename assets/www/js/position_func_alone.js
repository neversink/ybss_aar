function getCurrentPosition(o,t){navigator.userAgent.indexOf("Android")>0?baidu_location.getCurrentPosition(function(t){var e=t.lontitude,n=t.latitude;tlog("转换前x坐标",e),tlog("转换前y坐标",n);var a=bdToGaoDe(e,n),i=a[0],r=a[1];tlog("转换后x坐标",i),tlog("转换后y坐标",r),saveCurrentLat(r),saveCurrentLng(i),console.log("Android定位成功:"+i+","+r),o({latitude:r,lontitude:i})},function(o){console.log("Android定位失败"),t(o)}):navigator.userAgent.indexOf("iPhone")>0?(iOSLocateSuccessCallback=o,iOSLocateErrorCallback=t,AMap.event.addListener(geolocation,"complete",onLocateComplete),AMap.event.addListener(geolocation,"error",onLocateError),geolocation.getCurrentPosition()):(saveCurrentLat(24.4570158751),saveCurrentLng(118.0849411665),console.log("PC定位成功"),o({latitude:24.4570158751,lontitude:118.0849411665}))}function onLocateComplete(o){var t=new Object;t.latitude=o.position.getLat(),t.lontitude=o.position.getLng(),saveCurrentLat(t.latitude),saveCurrentLng(t.lontitude),console.log("iOS定位成功:"+t.latitude+","+t.lontitude),iOSLocateSuccessCallback(t)}function onLocateError(o){console.log("iOS定位失败",o),iOSLocateErrorCallback("定位失败")}function bdToGaoDe(o,t){var e=52.35987755982988,n=o-.0065,a=t-.006,i=Math.sqrt(n*n+a*a)-2e-5*Math.sin(a*e),r=Math.atan2(a,n)-3e-6*Math.cos(n*e),l=i*Math.cos(r),c=i*Math.sin(r);return[l,c]}var map,geolocation;navigator.userAgent.indexOf("iPhone")>0&&(map=new AMap.Map("container",{}),map.plugin("AMap.Geolocation",function(){geolocation=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e3})}));var iOSLocateSuccessCallback,iOSLocateErrorCallback;